{"componentChunkName":"component---src-templates-project-page-template-js","path":"/projects/pointCloudViewer/","result":{"data":{"markdownRemark":{"headings":[{"value":"Point Cloud Viewer","depth":1},{"value":"Overview","depth":2},{"value":"Disk to SysRAM","depth":2},{"value":"SysRAM to VRAM","depth":2},{"value":"Minimally Enclosing Sphere","depth":2},{"value":"The Camera","depth":2}],"html":"<h1>Point Cloud Viewer</h1>\n<h2>Overview</h2>\n<p>This is simple project in C++ that takes an ASCII point cloud as input and uses a number of DirectX12 APIs to render a visulisation of the point cloud to a <a href=\"https://james-door.github.io/cv/projects/window/\">Win32 Window</a> in real-time. The viewer doesn't have a graphical user interface, and is instead takes a single command-line argument which is the path of the ASCII point cloud to view. The below video is a rendering of a point cloud of the statue of the <a href=\"https://sketchfab.com/3d-models/12th-c-ce-water-moon-guanyin-point-cloud-996ce4d6401445ac9c26f927770df851\">Water-Moon Guanyin</a> using the viewer created by this project. The project can be built from the <a href=\"https://github.com/james-door/DX12-PCV\">Github repository</a> or, a pre-compiled binary can be downloaded using <a href=\"https://github.com/james-door/DX12-PCV/releases/tag/shareBinary\">GitHub Releases</a>.</p>\n<p><video src=\"pcv.mp4\"></video>\nThe developed viewer initially loads a point cloud in ASCII format from the computer's storage into the main memory of the CPU, also commonly referred to as the system RAM or SysRAM. Each point in the ASCII point clouds is then converted into a vertex, which is a particular arrangement of the data that the GPU can understand. This vertex, <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"0\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">PointCloudVertex</span></code>, holds both the position of the point and the colour as 32-bit floating point vectors of type <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"1\"><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">DirectX</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">XMFLOAT3</span></code>. This project chose to coalesce colour and position information, given that the vertex shader always accesses them together.</p>\n<pre class=\"grvsc-container C++__DX12-PCV/PointCloudRenderer.h__https://github.com/james-door/DX12-PCV/blob/main/PointCloudRenderer.h#L19 solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"19\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">struct</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">PointCloudVertex</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"20\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">\t</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">DirectX</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::XMFLOAT3 modelPos;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"21\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">\t</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">DirectX</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::XMFLOAT3 colour;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"22\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">\t</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">PointCloudVertex</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">const</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">DirectX</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">XMFLOAT3</span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> pos, </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">const</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">DirectX</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">XMFLOAT3</span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> col)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"23\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">\t\t: </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">modelPos</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(pos), </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">colour</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(col) {}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"24\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">};</span></span></span></code></pre>\n<p>The vertex information is then read from SysRAM to GPU-visible memory, which is either GPU-visible SysRAM or Video RAM (VRAM) depending on the device. Where VRAM refers to the physical RAM chips on the board that are reserved for the GPU. Each frame the vertex data is retrieved, the GPU uses it to draw individual points on the screen. Each of these points corresponds to a vertex in the point cloud, allowing the point cloud to be visualised.</p>\n<h2>Disk to SysRAM</h2>\n<p>The viewer only supports reading a single ASCII point cloud, the specified command-line argument representing the path of the point cloud is passed directly to the function <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"2\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">readPointCloudASC</span></code>. The ASCII data is read from disk into a number of chunks on the heap. These ASCII chunks are then converted into <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"3\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">PointCloudVertex</span></code> objects, as previously mentioned.</p>\n<p>Processing these chunks proved to be a bottleneck. The largest point cloud I tested, which is shown in the video above, comprised approximately 6 million points. Since it was a relatively small point cloud stored on an SSD, I found there was no I/O bottleneck. However, for larger point clouds I believe this could have been a consideration. To address the CPU-bound bottleneck I processed the chunks in parallel. I initially set the number of threads, <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"4\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">nThreads</span></code>, to <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"5\"><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">thread</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">hardware_concurrency</span></code>, however, I found that the overhead associated with this many  threads was greater than the performance gained for these small point clouds. On the small point clouds I found that using 4 threads gave the best performance.</p>\n<p>The program reads in the chunks sequentially. The size of the chunks, <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"6\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">chunkSize</span></code> is determined by <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"7\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">size </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">/</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> nThreads</span></code>. In the point clouds I was viewing, each point was separated by a new-line. In each point there are three floats representing the position, followed by three 8-bit integers representing the colour (assumedly in sRGB). Finally followed by three floats representing the normals. The number of characters, or bytes, per line is unknown, which prevented being able to carefully place the start and end of chunks to avoid cutting off points. Instead, I just read the chunks and if it cuts of a point midway append it to start of the next chunk. If the size of the ASCII point cloud is not divisible by <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"8\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">chunkSize</span></code>, the remainder is added onto the last chunk.</p>\n<pre class=\"grvsc-container C++__DX12-PCV/PointCloudViewer.cpp__https://github.com/james-door/DX12-PCV/blob/main/PointCloudViewer.cpp#L173 solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"173\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">unique_ptr</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">&lt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">vector</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">&lt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">PointCloudVertex</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">&gt;&gt; </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">readPointCloudASC</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">string</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> path)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"174\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"175\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">filesystem</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::path objPath </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> path;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"176\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">if</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">!</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">filesystem</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">exists</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(objPath))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"177\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">return</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-5 grvsc-t6zo1R-5\">nullptr</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"178\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">filesystem</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::path </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">filePath</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(objPath);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"179\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"180\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">auto</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> size </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">filesystem</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">file_size</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(objPath);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"181\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::ifstream </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">in</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(filePath, </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">ios</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::binary);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"182\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">unsigned</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">int</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> nThreads </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">min</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">4</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">U</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">thread</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">hardware_concurrency</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"183\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">if</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (nThreads </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&lt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"184\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        nThreads </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"185\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"186\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::vector</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&lt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::vector</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&lt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">PointCloudVertex</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">threadVertices</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(nThreads);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"187\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"188\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">unsigned</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">int</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> chunkSize </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> size </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">/</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> nThreads;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"189\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">unsigned</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">int</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> remainder </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> size </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">%</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> nThreads;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"190\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"191\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::vector</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&lt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::string</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(nThreads);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"192\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">int</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> endOfLineIndex </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"193\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"194\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">for</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (</span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">int</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> i </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">; i </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&lt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> nThreads; </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">++</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">i)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"195\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"196\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[i].</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">resize</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(chunkSize </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">+</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (i </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">==</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (nThreads </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">-</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">) </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">?</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> remainder </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">:</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"197\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">in</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">read</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[i].</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">data</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(), chunkSize </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">+</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (i </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">==</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (nThreads </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">-</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">) </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">?</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> remainder </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">:</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"198\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"199\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">if</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (i </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">||</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> endOfLineIndex </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[</span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">].</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">length</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"200\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"201\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">            </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[i] </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[i </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">-</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">].</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">substr</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(endOfLineIndex, </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[i </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">-</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">].</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">length</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">() </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">-</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> endOfLineIndex) </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">+</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[i];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"202\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">            </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[i </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">-</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">] </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[i </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">-</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">].</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">substr</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, endOfLineIndex);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"203\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"204\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"205\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        endOfLineIndex </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunks</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[i].</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">rfind</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-11 grvsc-t6zo1R-12\">&#39;</span><span class=\"grvsc-tiaGIi-4 grvsc-t6zo1R-4\">\\n</span><span class=\"grvsc-tiaGIi-11 grvsc-t6zo1R-12\">&#39;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"206\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        endOfLineIndex </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (endOfLineIndex </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">==</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">string</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::npos) </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">?</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">:</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> endOfLineIndex </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">+</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"207\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    }</span></span></span></code></pre>\n<p>Each chunk in <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"9\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">chunks</span></code> is then processed in parallel using the function <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"10\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">processPointCloudChunkASC</span></code>. This function reads the position, color, and normal information for each point. It stores the position information and the normalised color information, while discarding the normal information. The function approximates how much space to reserve for each point based on the average number of bytes observed per line in the formats being loaded. However, for ASCII formats with different levels of precision in floating-point numbers, this estimate will be off. Instead, this should could be an approximate average that is adjusted as more of the file is read.</p>\n<pre class=\"grvsc-container C++__DX12-PCV/PointCloudViewer.cpp__https://github.com/james-door/DX12-PCV/blob/main/PointCloudViewer.cpp#L156 solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"156\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">void</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">processPointCloudChunkASC</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">const</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">string</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">chunk, </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">vector</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">&lt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">PointCloudVertex</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">&gt;</span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">verts)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"157\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"158\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">verts</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">reserve</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">chunk</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">size</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">()</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">/</span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">64</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">);</span><span class=\"grvsc-tiaGIi-3 grvsc-tiaGIi-i grvsc-t6zo1R-3 grvsc-t6zo1R-i\"> //approximate number of verts</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"159\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"160\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> x, y, z;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"161\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">int</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> r, g, b;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"162\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> nx, ny, nz;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"163\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::istringstream </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">in</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(chunk);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"164\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"165\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">while</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (in </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> x </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> y </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> z </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> r </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> g </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> b </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> nx </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> ny </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> nz) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"166\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">verts</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">emplace_back</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"167\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">            </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">DirectX</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMFLOAT3</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(x, y, z),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"168\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">            </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">DirectX</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMFLOAT3</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(r </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">/</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">255.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, g </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">/</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">255.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, b </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">/</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">255.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"169\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"170\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"171\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">}</span></span></span></code></pre>\n<h2>SysRAM to VRAM</h2>\n<p>The exact process of transferring data from SysRAM to a location accessible by the GPU varies depending on whether the device employs a Unified Memory Architecture (UMA) or a Non-Unified Memory Architecture (NUMA). A UMA device is one in which both the CPU and GPU share the same RAM, which is typically the case when the GPU is integrated on the same die as the CPU. In contrast, a NUMA device is one in which the CPU and GPU each have their own separate RAM.</p>\n<p>While physically a NUMA PC has only two types of memory, the previously mentioned SysRAM and VRAM, logically, there are generally three main types.   To upload the point cloud vertices to the GPU, there are two logical types we need to consider. In Direct3D12, these are called the default and upload heaps. The default heap, <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"11\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">D3D12_HEAP_TYPE_DEFAULT</span></code>, has direct and fast access to the GPU and no direct access to the CPU. The upload heap, <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"12\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">D3D12_HEAP_TYPE_UPLOAD</span></code>, has direct access to the CPU and is GPU-visible, that is, it can be read directly or be transferred directly to the GPU.</p>\n<p>On a NUMA device, the code below queues up commands to allocate just enough memory in GPU-visible SysRAM and in VRAM to fit the point cloud vertices. The helper function <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"13\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">UpdateSubresources</span></code> queues commands to copy the vertices into the GPU-visible SysRAM and then for the memory to be transferred into the allocated VRAM. In a NUMA device, the GPU reads from SysRAM using a PCI Express bus. PCI Express 3.0, a common interface, offers bandwidths up to approximately 16 GB/s. This means that for small point clouds, the process is very quick. The code then submits the commands to the GPU and waits for them to execute. That is, it flushes the GPU.</p>\n<pre class=\"grvsc-container C++__DX12-PCV/PointCloudRenderer.cpp__https://github.com/james-door/DX12-PCV/blob/main/PointCloudRenderer.cpp#L82 solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"82\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    ComPtr</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&lt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">ID3D12Resource</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&gt;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> vertexStagingBufferResource;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"83\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    D3D12_RESOURCE_DESC vertexResourceDesc </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">CD3DX12_RESOURCE_DESC</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">Buffer</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(bufferSize);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"84\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"85\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">HANDLE_RETURN</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">device</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">-&gt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">CreateCommittedResource</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">CD3DX12_HEAP_PROPERTIES</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(D3D12_HEAP_TYPE_DEFAULT), D3D12_HEAP_FLAG_NONE,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"86\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">vertexResourceDesc, D3D12_RESOURCE_STATE_COPY_DEST, </span><span class=\"grvsc-tiaGIi-5 grvsc-t6zo1R-5\">nullptr</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">IID_PPV_ARGS</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">vertexResource)));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"87\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"88\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">HANDLE_RETURN</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">device</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">-&gt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">CreateCommittedResource</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">CD3DX12_HEAP_PROPERTIES</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(D3D12_HEAP_TYPE_UPLOAD), D3D12_HEAP_FLAG_NONE,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"89\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">vertexResourceDesc, D3D12_RESOURCE_STATE_GENERIC_READ, </span><span class=\"grvsc-tiaGIi-5 grvsc-t6zo1R-5\">nullptr</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">IID_PPV_ARGS</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">vertexStagingBufferResource)));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"90\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"91\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">cmdList</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">-&gt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">Reset</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">allocators</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">[activeBuffer].</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">Get</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(), </span><span class=\"grvsc-tiaGIi-5 grvsc-t6zo1R-5\">nullptr</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"92\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">UpdateSubresources</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">cmdList</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">Get</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(), </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">vertexResource</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">Get</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(), </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">vertexStagingBufferResource</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">Get</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(), </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">vertexSubResourceData);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"93\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">cmdList</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">-&gt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">Close</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"94\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"95\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"96\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-3 grvsc-tiaGIi-i grvsc-t6zo1R-3 grvsc-t6zo1R-i\">    //Execute Command queue</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"97\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    ID3D12CommandList</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">*</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> lists[] </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> { </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">cmdList</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">Get</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">() };</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"98\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">cmdQueue</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">-&gt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">ExecuteCommandLists</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, lists);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"99\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">flushGPU</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">();</span></span></span></code></pre>\n<h2>Minimally Enclosing Sphere</h2>\n<p>As I will discuss more in the section below <a href=\"#The%20Camera\">The Camera</a> one method for the user to be able to \"orbit\" the cloud using their cursor is to define a minimally enclosing sphere. Where a minimally enclosing sphere is a sphere with minimum radius that still holds each point in the cloud in its volume. This sphere, <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"14\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">ViewingSphere</span></code>, is described in the below struct, it has a <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"15\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">centre</span></code> and a <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"16\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">radius</span></code>.</p>\n<pre class=\"grvsc-container C++__DX12-PCV/PointCloudRenderer.h__https://github.com/james-door/DX12-PCV/blob/main/PointCloudRenderer.h#L70 solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"70\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">struct</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">ViewingSphere</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"71\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"72\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">DirectX</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::XMFLOAT3 centre;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"73\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> radius;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"74\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">};</span></span></span></code></pre>\n<p>The centre of the minimally enclosing sphere is the given by the centroid of the point cloud, which is calculted in the below function. The radius is then the maximum distance between each point in the cloud and the centroid.</p>\n<pre class=\"grvsc-container C++__DX12-PCV/PointCloudRenderer.cpp__https://github.com/james-door/DX12-PCV/blob/main/PointCloudRenderer.cpp#L440 solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"440\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">void</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">PointCloudRenderer</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">CalculateMinimumBoundingSphere</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">const</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">vector</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">&lt;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">PointCloudVertex</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">&gt;</span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> vertices) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"441\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-3 grvsc-tiaGIi-i grvsc-t6zo1R-3 grvsc-t6zo1R-i\">    //Caclulate centroid</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"442\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    XMVECTOR sumPos </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMVectorSet</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"443\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"444\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">for</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (</span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">const</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">auto</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> vert : vertices) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"445\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        XMVECTOR pos </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMLoadFloat3</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">vert</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">modelPos</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"446\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        sumPos </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMVectorAdd</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(sumPos, pos);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"447\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"448\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"449\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    sumPos </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMVectorScale</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(sumPos, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">/</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">vertices</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">size</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"450\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"451\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    XMFLOAT3 centre;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"452\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMStoreFloat3</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">centre, sumPos);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"453\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    XMVECTOR centroidVec </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMLoadFloat3</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">centre);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"454\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"455\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-3 grvsc-tiaGIi-i grvsc-t6zo1R-3 grvsc-t6zo1R-i\">    //Calcualte radius </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"456\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> maxDistance </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"457\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">for</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> (</span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">const</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">auto</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> vert : vertices) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"458\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        XMVECTOR pos </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMLoadFloat3</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">vert</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">modelPos</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"459\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        XMVECTOR distance </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMVector3Length</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMVectorSubtract</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(pos, centroidVec));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"460\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        </span><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> distanceValue;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"461\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMStoreFloat</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">&amp;</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">distanceValue, distance);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"462\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">        maxDistance </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-4\">std</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">::</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">max</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(maxDistance, distanceValue);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"463\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"464\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"465\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"466\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">    viewingSphere </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> { centre,maxDistance };</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"467\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">}</span></span></span></code></pre>\n<h2>The Camera</h2>\n<p>In the previous section a minimally enclosing sphere was calculated, one method to allow the user to orbit the point cloud is to imagine moving a camera along the surface of this sphere. In this method, the camera rotates as it moves along the surface to always look at the centre of the sphere.</p>\n<p>On a high level, the view matrix, <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"17\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">viewMatrix</span></code>, describes the position and orientation of a virtual camera in 3D space. The DirectXMath API provides a function <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"18\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">XMMatrixLookAtLH</span></code> which will generate a view matrix. All it requires is the position of this virtual camera and the point the camera is looking at, and some general up direction that is not colinear with vector defined by the points <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"19\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">cameraPos</span></code> and <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"20\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">target</span></code>.</p>\n<p>Spherical coordinates can be used to describe a position in three-dimensional space. A spherical coordinate consists of a distance from the origin, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding=\"application/x-tex\">\\rho</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ρ</span></span></span></span></span>, and two angles, the azimuth, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span></span>, and the polar angle, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span>. If we hold <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding=\"application/x-tex\">\\rho</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ρ</span></span></span></span></span> to be constant, then varying <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span></span> and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span> allows us to describe any point on the surface of a sphere with radius <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding=\"application/x-tex\">\\rho</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ρ</span></span></span></span></span>.These two degrees of freedom can be conveniently controlled using the horizontal and vertical movements of the mouse, respectively.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>ρ</mi><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace><mi>y</mi><mo>=</mo><mi>ρ</mi><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace><mi>z</mi><mo>=</mo><mi>ρ</mi><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace></mrow><annotation encoding=\"application/x-tex\">x = \\rho \\sin(\\theta) \\cos(\\phi) \\\\\ny = \\rho \\sin(\\theta) \\sin(\\phi) \\\\\nz = \\rho \\cos(\\theta) \\\\</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span></span></span></span></div>\n<p>Where <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ρ</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\rho \\geq0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>θ</mi><mo>≤</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">0\\leq\\theta\\leq\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span>, and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>ϕ</mi><mo>≤</mo><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">0\\leq\\phi\\leq2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span>.\nWe can modify this more traditional formulation of spherical coordinates to be more useful in world space, where the <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>-axis is up, and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>z</mi></mrow><annotation encoding=\"application/x-tex\">z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span></span> is into screen. To allow camera rotation around the <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>-axis without restricting movement to one direction when <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi><mo>=</mo><mn>0</mn><mi mathvariant=\"normal\">°</mi></mrow><annotation encoding=\"application/x-tex\">\\phi=0\\degree</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">0°</span></span></span></span></span> we can adjust the bounds of <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span></span>. Similarly for rotation around the <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span></span>-axis in both directions when <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>0</mn><mi mathvariant=\"normal\">°</mi></mrow><annotation encoding=\"application/x-tex\">\\theta=0\\degree</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">0°</span></span></span></span></span> we adjust the bounds of <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span>.  Also, by convention, I chose the general up vector, <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"21\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">up</span></code> to be <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">[0,1,0]^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span></span>. This will be colinear with the vector described by <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"22\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">cameraPos</span></code> and <code class=\"custom-inline-code solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"23\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">target</span></code> when the user is looking straight up, or straight down. To avoid this, I limited the range of <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span> so that it is less than <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span>.</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>ρ</mi><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace><mi>y</mi><mo>=</mo><mi>ρ</mi><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace><mi>z</mi><mo>=</mo><mi>ρ</mi><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace></mrow><annotation encoding=\"application/x-tex\">x = \\rho \\sin(\\theta) \\cos(\\phi) \\\\\ny = \\rho \\cos(\\theta) \\\\\nz = \\rho \\sin(\\theta) \\sin(\\phi) \\\\</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span></span></span></span></div>\n<p>Where <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ρ</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\rho \\geq0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ρ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mfrac><mi>π</mi><mn>2</mn></mfrac><mo>≤</mo><mi>θ</mi><mo>&#x3C;</mo><mfrac><mi>π</mi><mn>2</mn></mfrac></mrow><annotation encoding=\"application/x-tex\">-\\frac{\\pi}{2}\\leq\\theta\\lt\\frac{\\pi}{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0404em;vertical-align:-0.345em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&#x3C;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0404em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>, and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi>π</mi><mo>≤</mo><mi>ϕ</mi><mo>≤</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">-\\pi\\leq\\phi\\leq\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span>.</p>\n<pre class=\"grvsc-container C++__DX12-PCV/PointCloudRenderer.cpp__https://github.com/james-door/DX12-PCV/blob/main/PointCloudRenderer.cpp#L421 solarized-light grvsc-ps-tiaGIi grvsc-ps-t6zo1R\" data-language=\"c++\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"421\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> radius </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">viewingSphere</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">radius</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">*</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">2.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"422\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> theta </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMConvertToRadians</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(pitch </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">+</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">90</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"423\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> phi </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMConvertToRadians</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(yaw); </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"424\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> x </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> radius </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">*</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMScalarSin</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(theta) </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">*</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMScalarCos</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(phi);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"425\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> z </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> radius </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">*</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMScalarSin</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(theta) </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">*</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMScalarSin</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(phi);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"426\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-13 grvsc-tiaGIi-b grvsc-t6zo1R-1 grvsc-t6zo1R-b\">float</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> y </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> radius </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">*</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMScalarCos</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(theta);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"427\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">XMVECTOR cameraPos </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMVectorSet</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">viewingSphere</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">centroid</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">x</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">+</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> x, </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">viewingSphere</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">centroid</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">y</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">+</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> y, </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">viewingSphere</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">centroid</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">z</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">+</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> z, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"428\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">XMVECTOR target </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMVectorSet</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">viewingSphere</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">centroid</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">x</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">viewingSphere</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">centroid</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">y</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">viewingSphere</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">centroid</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">.</span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">z</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"429\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">XMVECTOR up </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMVectorSet</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(</span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">0.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">, </span><span class=\"grvsc-tiaGIi-6 grvsc-t6zo1R-6\">1.0</span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">f</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"430\"></span><span class=\"grvsc-source\"><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">viewMatrix </span><span class=\"grvsc-tiaGIi-8 grvsc-t6zo1R-9\">=</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\"> </span><span class=\"grvsc-tiaGIi-7 grvsc-t6zo1R-7\">XMMatrixLookAtLH</span><span class=\"grvsc-tiaGIi-1 grvsc-t6zo1R-1\">(cameraPos, target, up);</span></span></span></code></pre>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .solarized-light { background-color: #FDF6E3; }\n  .solarized-light .grvsc-tiaGIi-i { font-style: italic; }\n  .solarized-light .grvsc-tiaGIi-b { font-weight: bold; }\n  .solarized-light .grvsc-tiaGIi-13 { color: #073642; }\n  .solarized-light .grvsc-tiaGIi-1 { color: #657B83; }\n  .solarized-light .grvsc-tiaGIi-7 { color: #268BD2; }\n  .solarized-light .grvsc-tiaGIi-8 { color: #859900; }\n  .solarized-light .grvsc-tiaGIi-5 { color: #B58900; }\n  .solarized-light .grvsc-tiaGIi-6 { color: #D33682; }\n  .solarized-light .grvsc-tiaGIi-11 { color: #2AA198; }\n  .solarized-light .grvsc-tiaGIi-4 { color: #CB4B16; }\n  .solarized-light .grvsc-tiaGIi-3 { color: #93A1A1; }\n  .solarized-light .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n  html[colour-theme=light] .grvsc-ps-tiaGIi { background-color: #FDF6E3; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-i { font-style: italic; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-b { font-weight: bold; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-13 { color: #073642; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-1 { color: #657B83; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-7 { color: #268BD2; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-8 { color: #859900; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-5 { color: #B58900; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-6 { color: #D33682; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-11 { color: #2AA198; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-4 { color: #CB4B16; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-tiaGIi-3 { color: #93A1A1; }\n  html[colour-theme=light] .grvsc-ps-tiaGIi .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R { background-color: #002B36; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-t6zo1R-i { font-style: italic; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-t6zo1R-b { font-weight: bold; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-t6zo1R-1 { color: #93A1A1; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-t6zo1R-4 { color: #CB4B16; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-t6zo1R-7 { color: #268BD2; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-t6zo1R-9 { color: #859900; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-t6zo1R-5 { color: #B58900; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-t6zo1R-6 { color: #D33682; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-t6zo1R-12 { color: #2AA198; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-t6zo1R-3 { color: #657B83; }\n  html[colour-theme=dark] .grvsc-ps-t6zo1R .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>"}},"pageContext":{"slug":"projects/pointCloudViewer"}},"staticQueryHashes":["4149348717"],"slicesMap":{}}